<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Ciclo de Dashboards</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    html, body {
      margin: 0; padding: 0; height: 100%;
      background: #000; overflow: hidden;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }
    iframe {
      width: 100%; height: 100%; border: none; background: #000;
    }
    #fullscreenBtn {
      position: absolute; bottom: 12px; right: 12px; z-index: 9999;
      padding: 10px 16px; font-size: 16px; border: 0; border-radius: 10px;
      background: #1a73e8; color: #fff; cursor: pointer;
      box-shadow: 0 6px 18px rgba(0,0,0,.35);
    }
    #fullscreenBtn:active { transform: translateY(1px); }
  </style>
</head>
<body>
  <iframe id="lookerFrame" src="" title="Dashboard/Agenda"></iframe>
  <button id="fullscreenBtn" onclick="openFullscreen()">Tela Cheia</button>

  <script>
    // =========================
    // 1) CONFIGURAÇÕES
    // =========================

    // Cloudflare Worker (proxy) – deixe este valor como o SEU endpoint:
    const WORKER_BASE = "https://long-pine-4dbc.felipe-5cb.workers.dev/?url=";

    // Dashboards Looker (adicione/remova à vontade)
    const LOOKER = [
      "https://lookerstudio.google.com/embed/reporting/22049608-7769-4771-950c-f8e0715b3813/page/qzTwE",
      "https://lookerstudio.google.com/embed/reporting/b6b28955-f492-46c1-af56-76c2b7bd0dae/page/p_90t3bvjrvd",
      "https://lookerstudio.google.com/embed/reporting/7d1dc1f2-ed34-459b-9e10-8135eeb67043/page/p_og79bl4vvd"
    ];

    // Agendas (troque os .ics abaixo pelos PRIVATE se quiser ver nomes reais)
    // Dica: para títulos reais, prefira o "Endereço secreto em iCal" (private-.../basic.ics)
    const CALS = [
      {
        name: "Agenda — Monique",
        ics:  "https://calendar.google.com/calendar/ical/monique.moreira%40metodo12p.com.br/public/basic.ics",
        tz:   "America/Sao_Paulo"
      },
      {
        name: "Agenda — Thiago",
        ics:  "https://calendar.google.com/calendar/ical/thiago.cardoso%40metodo12p.com.br/public/basic.ics",
        tz:   "America/Sao_Paulo"
      },
      {
        name: "Agenda — Fernando",
        ics:  "https://calendar.google.com/calendar/ical/fernando%40metodo12p.com.br/public/basic.ics",
        tz:   "America/Sao_Paulo"
      }
    ];

    // Tempo de cada slide (ms)
    const INTERVAL_MS = 5 * 60 * 1000; // 5 minutos

    // =========================
    // 2) HELPERS
    // =========================
    const calendarSlide = ({ ics, name, tz }) =>
      "calendar.html?ics=" + encodeURIComponent(WORKER_BASE + encodeURIComponent(ics)) +
      "&name=" + encodeURIComponent(name) +
      "&tz="   + encodeURIComponent(tz || "America/Sao_Paulo");

    // Monta a lista final (Looker + Agendas)
    const dashboards = [
      ...CALS.map(calendarSlide),
      ...LOOKER
    ];

    // =========================
    // 3) SLIDES / FULLSCREEN
    // =========================
    let currentIndex = 0;
    const frame = document.getElementById("lookerFrame");

    function cycleDashboards() {
      frame.src = dashboards[currentIndex];
      currentIndex = (currentIndex + 1) % dashboards.length;
    }

    function openFullscreen() {
      const elem = document.documentElement;
      const btn  = document.getElementById("fullscreenBtn");
      const hide = () => btn.style.display = "none";

      if (elem.requestFullscreen) elem.requestFullscreen().then(hide).catch(console.error);
      else if (elem.webkitRequestFullscreen) { elem.webkitRequestFullscreen(); hide(); }
      else if (elem.msRequestFullscreen)     { elem.msRequestFullscreen(); hide(); }
      else alert("Modo tela cheia não suportado neste navegador.");
    }

    // Start
    cycleDashboards();
    setInterval(cycleDashboards, INTERVAL_MS);
  </script>
</body>
</html>
